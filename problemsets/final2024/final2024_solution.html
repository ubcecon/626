<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Paul Schrimpf">
<meta name="dcterms.date" content="2024-12-14">

<title>ECON 626: Final – ECON 626</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-4afa585e620e1e545a967878b225e89b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ECON 626</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus626.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../slides.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#air-pollution-monitoring" id="toc-air-pollution-monitoring" class="nav-link active" data-scroll-target="#air-pollution-monitoring">Air-Pollution Monitoring</a>
  <ul class="collapse">
  <li><a href="#identifying-assumption-7-points" id="toc-identifying-assumption-7-points" class="nav-link" data-scroll-target="#identifying-assumption-7-points">Identifying Assumption (7 points)</a></li>
  <li><a href="#dependence-7-points" id="toc-dependence-7-points" class="nav-link" data-scroll-target="#dependence-7-points">Dependence (7 points)</a></li>
  <li><a href="#twfe-7-points" id="toc-twfe-7-points" class="nav-link" data-scroll-target="#twfe-7-points">TWFE (7 points)</a></li>
  <li><a href="#linear-control-12-points-6-for-each-part" id="toc-linear-control-12-points-6-for-each-part" class="nav-link" data-scroll-target="#linear-control-12-points-6-for-each-part">Linear Control (12 points, 6 for each part)</a></li>
  </ul></li>
  <li><a href="#media-and-political-persuasion" id="toc-media-and-political-persuasion" class="nav-link" data-scroll-target="#media-and-political-persuasion">Media and Political Persuasion</a>
  <ul class="collapse">
  <li><a href="#consistency-7-points" id="toc-consistency-7-points" class="nav-link" data-scroll-target="#consistency-7-points">Consistency (7 points)</a></li>
  <li><a href="#estimation-of-gamma-7-points" id="toc-estimation-of-gamma-7-points" class="nav-link" data-scroll-target="#estimation-of-gamma-7-points">Estimation of <span class="math inline">\(\gamma\)</span> (7 points)</a></li>
  <li><a href="#asymptotic-normality-12-points-6-for-each-part" id="toc-asymptotic-normality-12-points-6-for-each-part" class="nav-link" data-scroll-target="#asymptotic-normality-12-points-6-for-each-part">Asymptotic Normality (12 points, 6 for each part)</a></li>
  </ul></li>
  <li><a href="#telehealth-and-healthcare-utilization" id="toc-telehealth-and-healthcare-utilization" class="nav-link" data-scroll-target="#telehealth-and-healthcare-utilization">Telehealth and Healthcare Utilization</a>
  <ul class="collapse">
  <li><a href="#endogeneity-7-points" id="toc-endogeneity-7-points" class="nav-link" data-scroll-target="#endogeneity-7-points">Endogeneity (7 points)</a></li>
  <li><a href="#instrument-7-points" id="toc-instrument-7-points" class="nav-link" data-scroll-target="#instrument-7-points">Instrument (7 points)</a></li>
  <li><a href="#instrument-strength-7-points" id="toc-instrument-strength-7-points" class="nav-link" data-scroll-target="#instrument-strength-7-points">Instrument Strength (7 points)</a></li>
  <li><a href="#dependence-7-points-1" id="toc-dependence-7-points-1" class="nav-link" data-scroll-target="#dependence-7-points-1">Dependence (7 points)</a></li>
  <li><a href="#late-7-points" id="toc-late-7-points" class="nav-link" data-scroll-target="#late-7-points">LATE? (7 points)</a></li>
  <li><a href="#nonstandard-3sls-7-points" id="toc-nonstandard-3sls-7-points" class="nav-link" data-scroll-target="#nonstandard-3sls-7-points">Nonstandard 3SLS (7 points)</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  <li><a href="#definitions-and-results" id="toc-definitions-and-results" class="nav-link" data-scroll-target="#definitions-and-results">Definitions and Results</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">ECON 626: Final</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Paul Schrimpf </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 14, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><span class="math display">\[
\def\R{{\mathbb{R}}}
\def\Er{{\mathrm{E}}}
\def\var{{\mathrm{Var}}}
\newcommand\norm[1]{\left\lVert#1\right\rVert}
\def\cov{{\mathrm{Cov}}}
\def\En{{\mathbb{E}_n}}
\def\rank{{\mathrm{rank}}}
\newcommand{\inpr}{ \overset{p^*_{\scriptscriptstyle n}}{\longrightarrow}}
\def\inprob{{\,{\buildrel p \over \rightarrow}\,}}
\def\indist{\,{\buildrel d \over \rightarrow}\,}
\DeclareMathOperator*{\plim}{plim}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}
\]</span></p>
<p>You have 150 minutes to complete the exam. The last two pages have some possibly useful formulas.</p>
<p>There are 100 total points. Each part of a question is worth either 6 or 7 points. Some questions are harder than others. Be careful not to get stuck on one question for too long. To help with budgeting your time, I’ve labeled two questions as <em>More difficult</em> and two as <em>Most difficult</em>.</p>
<section id="air-pollution-monitoring" class="level1">
<h1>Air-Pollution Monitoring</h1>
<p>In “Achieving Air Pollution Control Targets with Technology-Aided Monitoring: Better Enforcement or Localized Efforts?” <span class="citation" data-cites="yang2024">Yang et al. (<a href="#ref-yang2024" role="doc-biblioref">2024</a>)</span> study the impact of automated air pollution monitoring stations in Chinese cities.</p>
<p><span class="citation" data-cites="yang2024">Yang et al. (<a href="#ref-yang2024" role="doc-biblioref">2024</a>)</span> estimate the following difference in differences regression <span id="eq-twfe"><span class="math display">\[
\ln(PM2.5_{ict}) = \alpha Auto_{ct} + \beta Near_i \times Auto_{ct} + \gamma X_{ct} + Cell_i + Year_t + \epsilon_{ict}
\tag{1}\]</span></span></p>
<p>where <span class="math inline">\(\ln(PM2.5_{ict})\)</span> is the log particulate matter in area cell <span class="math inline">\(i\)</span> (measured by satelite) in city <span class="math inline">\(c\)</span> and year <span class="math inline">\(t\)</span>, <span class="math inline">\(Auto_{ct}\)</span> is whether the automated monitoring program is in effect in city <span class="math inline">\(c\)</span> and year <span class="math inline">\(t\)</span>, <span class="math inline">\(Near_i\)</span> is whether cell <span class="math inline">\(i\)</span> is near an automated monitoring station, and <span class="math inline">\(X_{ct}\)</span> are controls. Table 2 shows the results.</p>
<p><img src="yang-tab2.png" class="img-fluid" style="width:80.0%"></p>
<section id="identifying-assumption-7-points" class="level2">
<h2 class="anchored" data-anchor-id="identifying-assumption-7-points">Identifying Assumption (7 points)</h2>
<p>In columns (1) and (2), which omit <span class="math inline">\(\beta Near_i \times Auto_{ct}\)</span>, what assumption(s) must be made for the estimated coefficient on <span class="math inline">\(Auto_{ct}\)</span> to be a consistent estimate of the average treatment effect on the treated of the automated monitoring program?</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>This difference in difference estimation is motivated by a (conditional) parallel trends assumption, i.e.&nbsp;if <span class="math inline">\(y_{ict} = \ln(PM2.5_{ict})\)</span> with potential outcomes <span class="math inline">\(y_{ict}(auto)\)</span>, then the parallel trends assumption is <span class="math display">\[
\Er[y_{ict}(0) - y_{ict-\ell}(0) | Auto_{ct}=1, Auto_{ct-\ell} = 0, X_{ct}, X_{ct-\ell}] =
\Er[y_{ict}(0) - y_{ict-\ell}(0) | Auto_{ct}=0, Auto_{ct-\ell} = 0, X_{ct}, X_{ct-\ell}]
\]</span> However, the estimated linear model imposes some additional assumptions. Let <span class="math inline">\(\tilde{y}_{ict}(auto)\)</span> be the residuals from the population regression of <span class="math inline">\(y_{ict}(auto)\)</span> on <span class="math inline">\(X_{ct}\)</span>. If all cities were treated in the same period or treatment effects do not vary with time, then <span class="math inline">\(\alpha\)</span> is an estimate of the ATT if we have parallel trends for the residualized outcomes. <span class="math display">\[
\Er[\tilde{y}_{ict}(0) - \tilde{y}_{ict-\ell}(0) | Auto_{ct}=1, Auto_{ct-\ell} = 0 ] =
\Er[\tilde{y}_{ict}(0) - \tilde{y}_{ict-\ell}(0) | Auto_{ct}=0, Auto_{ct-\ell} = 0]
\]</span></p>
<p>A technically correct, but not the best answer, would be that <span class="math inline">\(\Er[Auto_{ct} \epsilon_{ict}] = 0\)</span> and <span class="math inline">\(\Er[X_{ct}\epsilon_{ict}] = 0\)</span>.</p>
<p>Any answer here that correctly describe parallel trends should receive 5 points. For full credit the answer should also recognize that something more is needed.</p>
</div>
</section>
<section id="dependence-7-points" class="level2">
<h2 class="anchored" data-anchor-id="dependence-7-points">Dependence (7 points)</h2>
<p>The sample here consists of areas / “cells” <span class="math inline">\(i\)</span> within cities <span class="math inline">\(c\)</span> in years <span class="math inline">\(t\)</span>. How does this affect the consistency and asymptotic distribution of the estimates. What in the table, if anything, needs to be calculated differently than if observations were independent?</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>Standard errors should allow for spatial and/or time dependence. If we believe that observations from different cities are uncorrelated, then standard errors clustered on city level are sufficient. HAC standard errors could also be used.</p>
</div>
</section>
<section id="twfe-7-points" class="level2">
<h2 class="anchored" data-anchor-id="twfe-7-points">TWFE (7 points)</h2>
<p>The pollution monitoring program was implemented in three waves — some cities became treated earlier than others. Briefly describe a problem with <a href="#eq-twfe" class="quarto-xref">Equation&nbsp;1</a> and describe what should have been done instead.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>The fixed effects estimator is a weighted average, with possible negative weights, of time specific treatment effects. This can be problematic if the treatment effect varies with time. Instead of fixed effects, an estimator that allows for different effects for different time periods and cohorts should be used.</p>
</div>
</section>
<section id="linear-control-12-points-6-for-each-part" class="level2">
<h2 class="anchored" data-anchor-id="linear-control-12-points-6-for-each-part">Linear Control (12 points, 6 for each part)</h2>
<p>As noted on the table, columns (3), (5), and (6) include a ``concurrent policy’’ control. This is a concurrent policy also aimed at pollution control. This question analyzes whether it is sufficient to additively control for this concurrent policy. To simplify, denote the outcome by <span class="math inline">\(y_{ct}\)</span>, suppose the only treatment is <span class="math inline">\(Auto_{ct}\)</span> and denote it by <span class="math inline">\(D_{ct}\)</span>, and let <span class="math inline">\(X_{ct} \in \{0,1\}\)</span> be the concurrent policy. Also assume the treatment only begins at one time. Assume conditional parallel trends, <span class="math display">\[
\Er[Y_{ct}(0) - Y_{c t-\ell}(0) | X_{ct}, X_{ct-\ell}, D_{ct} = 1, D_{c,t-\ell}=0] = \Er[Y_{ct}(0) - Y_{c t-\ell}(0) | X_{ct}, X_{c,t-\ell}, D_{ct} = 0, D_{ct-\ell} = 0].
\]</span></p>
<ol type="1">
<li><p>Do you think the regression, <span class="math display">\[
y_{ct} = \alpha D_{ct} + \gamma X_{ct} + \lambda_c + \delta_t + \epsilon_{ct},
\]</span> is likely to produce a consistent estimate of an interpretable treatment effect? Why or why not? (Your answer need not be completely rigorous; you can argue by analogy, e.g.&nbsp;“this is similar to XX in that YY, so it should be [not] okay.”)</p></li>
<li><p>Describe a consistent estimator for the average treatment effect on the treated.</p></li>
</ol>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<ol type="1">
<li><p>No, this regression is not guaranteed to produce a consistent estimate of an interpretable treatment effect. As with TWFE, we can write the estimate as <span class="math display">\[
\hat{\alpha} = \sum y_{ct}(0) \hat{\omega}_{ct} + \sum (y_{ct}(1) - y_{ct}(0)) \hat{\omega}_{ct}
\]</span> where <span class="math display">\[
\hat{\omega}_{ct} = \frac{\tilde{D}_{ct}}{\sum \tilde{D}_{ct}^2}
\]</span> and <span class="math inline">\(\tilde{D}_{ct}\)</span> are the residuals from regressing <span class="math inline">\(D\)</span> on <span class="math inline">\(X\)</span> and fixed effects. As with just TWFE, some <span class="math inline">\(\tilde{D}_{ct}\)</span> could be negative. Moreover, even if none are negative, <span class="math inline">\(\hat{\alpha}\)</span> is a difficult to interpret weighted average of treatment effects.</p></li>
<li><p>A plug-in estimator will be a consistent estimator for the ATT. Conditional parallel trends implies that <span class="math display">\[
ATT = \Er_X\left[ \Er[y_{ct}-y_{ct-\ell} | X_{ct},X_{ct-\ell},D_{ct}=1,D_{ct-\ell}=0] - \Er[y_{ct}-y_{ct-\ell} | X_{ct},X_{ct-\ell},D_{ct}=0,D_{ct-\ell}=0] \right].
\]</span> Replacing the above population expectations with sample averages will give a consistent estimator.</p></li>
</ol>
<p>Alternatively, a “saturated” regression that includes an interaction between <span class="math inline">\(D\)</span> and <span class="math inline">\(X\)</span> will also give a consistent estimate.</p>
</div>
</section>
</section>
<section id="media-and-political-persuasion" class="level1">
<h1>Media and Political Persuasion</h1>
<p>In “Media and Political Persuasion: Evidence from Russia,” <span class="citation" data-cites="epz2011">Enikolopov, Petrova, and Zhuravskaya (<a href="#ref-epz2011" role="doc-biblioref">2011</a>)</span> compare electoral outcomes of 1999 parliamentary elections in Russia among geographical areas with differential access to the only national TV channel independent from the government. Availability of the independent TV channel (NTV) varies with geography due to the location of transmission towers and topography. The model of interest is</p>
<p><span id="eq-vote"><span class="math display">\[
v_s = \beta_0 + \beta_1 NTV_s + \epsilon_s
\tag{2}\]</span></span></p>
<p>where <span class="math inline">\(v_s\)</span> is the vote share of the incumbent party in region <span class="math inline">\(s\)</span>, and <span class="math inline">\(NTV_s\)</span> is the portion of households in region <span class="math inline">\(s\)</span> with NTV available. Assume that <span class="math inline">\(\Er[\epsilon_s NTV_s] = 0\)</span> (the paper includes additional controls that make this assumption plausible, but the model is simplified for this question). Unfortunately, the authors do not observe <span class="math inline">\(NTV_s\)</span> directly. Instead, they used a physics model of transmitter and household location and topography in between to construct a measure of NTV signal strength in each location. They then surveyed <span class="math inline">\(n\)</span> households about NTV availability and estimated a probit model, <span class="math display">\[
P(NTV_i | signal_i) = \Phi(\gamma signal_i)
\]</span> The estimates from this model were then used to construct <span class="math display">\[
\widehat{NTV}_s = \Phi(\hat{\gamma} signal_s),
\]</span> and estimated the model of interest using <span class="math inline">\(\widehat{NTV}_s\)</span> in place of <span class="math inline">\(NTV_s\)</span></p>
<section id="consistency-7-points" class="level2">
<h2 class="anchored" data-anchor-id="consistency-7-points">Consistency (7 points)</h2>
<p>(<em>More difficult</em>) Assume that the probit model is correctly specified so that <span class="math inline">\(NTV_s = \Phi(\gamma signal_s)\)</span>, and that <span class="math inline">\(|\gamma - \hat{\gamma}| = O_p(n^{-1/2})\)</span>. Show that the OLS estimate of <a href="#eq-vote" class="quarto-xref">Equation&nbsp;2</a> using <span class="math inline">\(\widehat{NTV}_s\)</span> in place of <span class="math inline">\(NTV_s\)</span> is consistent as the number of regions, <span class="math inline">\(S\)</span>, and number of survey respondents, <span class="math inline">\(n\)</span>, both approach infinity. Clearly state any extra assumptions you make.</p>
<p>(<em>Hint: to reduce notation, you may assume that <span class="math inline">\(NTV\)</span> and <span class="math inline">\(\widehat{NTV}\)</span> have mean zero. It suffices to show that <span class="math inline">\(\frac{1}{S} \sum_s \widehat{NTV}_s NTV_s \inprob \Er[NTV_s^2]\)</span>, <span class="math inline">\(\frac{1}{S} \sum_s \widehat{NTV}_s \epsilon_s \inprob \Er[NTV_s \epsilon_s]\)</span>, and <span class="math inline">\(\frac{1}{S} \sum_s \widehat{NTV}_s^2 \inprob \Er[NTV_s^2]\)</span>. Note that using the intermediate value theorem and the fact that the derivative of <span class="math inline">\(\Phi\)</span> is bounded by <span class="math inline">\(1/\sqrt{2\pi}\)</span>, we have <span class="math inline">\(|NTV_s - \widehat{NTV}_s| \leq 1/\sqrt{2\pi} |signal_s(\gamma - \hat{\gamma})|\)</span>. The Cauchy-Schwarz inequality might be useful.</em>).</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>The estimator is <span class="math display">\[
\hat{\beta}_1 = \frac{\sum \widehat{NTV}_s  v_s}{\sum \widehat{NTV}_s^2}
\]</span> Substituting in the model for <span class="math inline">\(v_s\)</span>, we have <span class="math display">\[
\hat{\beta}_1 = \beta_1 \frac{\sum \widehat{NTV}_s NTV_s}{\sum \widehat{NTV}_s^2} + \frac{\sum \widehat{NTV}_s \epsilon_s}{\sum \widehat{NTV}_s^2}
\]</span> First, we show that the last term with <span class="math inline">\(\epsilon_s\)</span> converges to 0. Note that <span class="math display">\[
\begin{align*}
\frac{1}{S} \sum \widehat{NTV}_s \epsilon_s
&amp; = \frac{1}{S} \sum NTV_s \epsilon_s + \frac{1}{S}\sum (\hat{NTV}_s - NTV_s)\epsilon_s \\
\left\vert\frac{1}{S} \sum \widehat{NTV}_s \epsilon_s\right\vert &amp; \leq \left\vert \frac{1}{S} \sum NTV_s \epsilon_s \right\vert + \sqrt{ \left(\frac{1}{S} \sum 1/(2\pi) signal_s^2 (\gamma - \hat{\gamma})^2  \right)
\left( \frac{1}{S} \sum \epsilon_s^2 \right) }
&amp; \inprob 0
\end{align*}
\]</span> where we used the hint and the Cauchy-Schwarz inequality in the second line, and the third line follows from assuming LLNs apply to <span class="math inline">\(\frac{1}{S} \sum NTV_s \epsilon_s\)</span>, <span class="math inline">\(\frac{1}{S}\sum signal_s^2\)</span>, and <span class="math inline">\(\frac{1}{S} \sum \epsilon_s^2\)</span>, and the assumption that <span class="math inline">\(\hat{\gamma} \inprob \gamma\)</span>.</p>
<p>An identical argument would show that <span class="math inline">\(\frac{1}{S} \sum \widehat{NTV}_s NTV_s \inprob \Er[NTV_s^2]\)</span>.</p>
<p>Finally, <span class="math display">\[
\begin{align*}
\frac{1}{S} \sum \widehat{NTV}_s^2 = &amp; \frac{1}{S} \sum NTV_s^2 + \frac{1}{S} \sum (\widehat{NTV}_s^2 - NTV_s^2) \\
= &amp; \frac{1}{S} \sum NTV_s^2 + \frac{1}{S} \sum \underbrace{2\Phi(\overline{\gamma signal_s}) \phi(\overline{\gamma signal_s})}_{\leq 2/\sqrt{2\pi}} (\hat{\gamma} - \gamma) \\
\inprob &amp; \Er[NTV_s^2]
\end{align*}
\]</span> where the second line used the intermediate value theorem and the last line used the assumption that <span class="math inline">\(\hat{\gamma} \inprob \gamma\)</span> and an LLN applies to <span class="math inline">\(\frac{1}{S} \sum NTV_s^2\)</span>.</p>
</div>
</section>
<section id="estimation-of-gamma-7-points" class="level2">
<h2 class="anchored" data-anchor-id="estimation-of-gamma-7-points">Estimation of <span class="math inline">\(\gamma\)</span> (7 points)</h2>
<p>Explain how to use GMM to estimate <span class="math inline">\(\gamma\)</span>. State the moment condition(s) and the objective function. (<em>Hint: the assumptions above can be re-written as <span class="math inline">\(\Er[NTV_i - \Phi(\gamma signal_i) | signal_i] = 0\)</span></em>).</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>The conditional moment restriction <span class="math inline">\(\Er[NTV_i - \Phi(\gamma signal_i) | signal_i] = 0\)</span> implies that <span class="math inline">\(\Er[\left(NTV_i - \Phi(\gamma signal_i)\right)signal_i] = 0\)</span>. This gives one moment condition to estimate one parameter. We can estimate <span class="math inline">\(\gamma\)</span> by minimizing the norm of the empirical moment, <span class="math display">\[
\hat{\gamma} \in \argmin_\gamma \left( \frac{1}{n} \sum_i (NTV_i - \Phi(\gamma signal_i))signal_i \right)^2.
\]</span></p>
</div>
</section>
<section id="asymptotic-normality-12-points-6-for-each-part" class="level2">
<h2 class="anchored" data-anchor-id="asymptotic-normality-12-points-6-for-each-part">Asymptotic Normality (12 points, 6 for each part)</h2>
<ol type="1">
<li><p>(<em>More difficult</em>) Suppose <span class="math inline">\(n &gt;&gt; S\)</span>, so that it is sensible to consider asymptotics where <span class="math inline">\(n \to \infty\)</span>, <span class="math inline">\(S \to \infty\)</span>, and <span class="math inline">\(S/n \to 0\)</span>. Assume that <span class="math inline">\(|signal_s|\)</span> is bounded. Show that the usual OLS standard errors are correct when estimating <a href="#eq-vote" class="quarto-xref">Equation&nbsp;2</a> with <span class="math inline">\(\widehat{NTV}_s\)</span> in place of <span class="math inline">\(NTV_s\)</span>. (<em>Hint: Derive the asymptotic distribution <span class="math inline">\(\sqrt{S}(\hat{\beta}_1 - \beta_1)\)</span>. The fact that <span class="math inline">\(\max_{1\leq s \leq S} |NTV_s - \widehat{NTV}_s| \leq 1/\sqrt{2\pi} (\max_s |signal_s| ) |\gamma - \hat{\gamma}|\)</span> might be useful.</em>).</p></li>
<li><p>(<em>Most difficult</em>) Now suppose <span class="math inline">\(n\)</span> is close to <span class="math inline">\(S\)</span>, and consider asymptotics where <span class="math inline">\(n \to \infty\)</span>, <span class="math inline">\(S \to \infty\)</span>, and <span class="math inline">\(S/n \to c\)</span> for some constant <span class="math inline">\(c &gt; 0\)</span>. Derive the asymptotic distribution of <span class="math inline">\(\hat{\beta}_1\)</span> when estimating <a href="#eq-vote" class="quarto-xref">Equation&nbsp;2</a> with <span class="math inline">\(\widehat{NTV}_s\)</span> in place of <span class="math inline">\(NTV_s\)</span>.</p></li>
</ol>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span></p>
<ol type="1">
<li>Note that <span class="math display">\[
\sqrt{S}(\hat{\beta}_1 - \beta_1) = \frac{\frac{1}{\sqrt{S}} \sum_s \widehat{NTV}_s\left((NTV_s - \widehat{NTV}_s) + \epsilon_s\right)}
{ \frac{1}{S} \sum_s \widehat{NTV}_s^2}
\]</span> as in the consistency section, <span class="math inline">\(\frac{1}{S} \sum_s \widehat{NTV}_s^2 \inprob \Er[NTV_s^2]\)</span>. Also, similar to that section, <span class="math display">\[
\frac{1}{\sqrt{S}} \sum_s \widehat{NTV}_s \epsilon_s = \frac{1}{\sqrt{S}} \sum_s NTV_s \epsilon_s + \frac{1}{\sqrt{S}} \sum_s (\widehat{NTV}_s - NTV_s) \epsilon_s
\]</span> and <span class="math display">\[
\begin{align*}
\left\vert \frac{1}{\sqrt{S}} \sum_s (\widehat{NTV}_s - NTV_s) \epsilon_s \right\vert \leq &amp;
\left\vert \frac{1}{\sqrt{S}} \sum_s |signal_s| \epsilon_s 1/(2\pi) |\hat{\gamma} - \gamma| \right\vert \\
\inprob &amp; 0
\end{align*}
\]</span> where we used the intermediate value theorem on the first line, and then assumed that a CLT applies to <span class="math inline">\(\frac{1}{\sqrt{S}} \sum_s |signal_s|\epsilon_s\)</span>, and the fact that <span class="math inline">\(\hat{\gamma} \inprob \gamma\)</span> to get the second line.</li>
</ol>
<p>Next, note that</p>
<p><span class="math display">\[
\begin{align*}
\left\vert \frac{1}{\sqrt{S}} \sum_s \widehat{NTV}_s\left((NTV_s - \widehat{NTV}_s) \right) \right\vert
&amp; \leq \left\vert \frac{1}{\sqrt{S}} \sum_s 1/\sqrt{2\pi} |signal_s(\gamma - \hat{\gamma}|
\right\vert \\
&amp; \leq \sqrt{S} B |\gamma - \hat{\gamma}| \\
&amp; \leq O_p\left(\sqrt{S/n}\right) \inprob 0
\end{align*}
\]</span></p>
<p>where we used the fact that <span class="math inline">\(|\widehat{NTV}| &lt; 1\)</span> and the assumption that <span class="math inline">\(|signal_s|\)</span> is bounded.</p>
<p>Finally, we can conclude that <span class="math display">\[
\sqrt{S}(\hat{\beta}_1 - \beta_1) = \frac{\frac{1}{\sqrt{S}} \sum_s NTV_s \epsilon_s}{\frac{1}{S} \sum_s NTV_s^2} + o_p(1) \indist N(0,V),
\]</span> the same asymptotic distribution as if <span class="math inline">\(NTV_s\)</span> were observed.</p>
<ol start="2" type="1">
<li>I revised the question to not have this part, but the idea is that under this assumption, <span class="math display">\[
\frac{1}{\sqrt{S}} \sum_s \widehat{NTV}_s\left((NTV_s - \widehat{NTV}_s) \right)
\]</span> will no longer be <span class="math inline">\(o_p(1)\)</span> and instead will contribute another term to the asymptotic distribution, which reflects estimation error in <span class="math inline">\(\hat{\gamma}\)</span>.</li>
</ol>
</div>
</section>
</section>
<section id="telehealth-and-healthcare-utilization" class="level1">
<h1>Telehealth and Healthcare Utilization</h1>
<p>In “Impact of Telehealth and Process Virtualization on Healthcare Utilization” <span class="citation" data-cites="ayabakan2024">Ayabakan, Bardhan, and Zheng (<a href="#ref-ayabakan2024" role="doc-biblioref">2024</a>)</span> study the impact of telehealth visits on subsequent healthcare utilitization. They estimate the following linear model: <span class="math display">\[
Util_{iht} = \beta_1 Telehealth_{iht} + \beta Controls_{iht} + \theta_i + \varphi_h + \lambda_t + \epsilon_{iht}
\]</span> where <span class="math inline">\(Util_{iht}\)</span> is a measure of healthcare utilization in the next 30 days (either number of visits or cost), <span class="math inline">\(Telehealth_{iht}\)</span> is an indicator for whether the initial visit was via telehealth or in-person, <span class="math inline">\(\theta_i\)</span> are patient fixed effects, <span class="math inline">\(\varphi_h\)</span> are healthcare provider fixed effects, and <span class="math inline">\(\lambda_t\)</span> are time (quarter) fixed effects. Controls include patient medical history and provider characteristics.</p>
<section id="endogeneity-7-points" class="level2">
<h2 class="anchored" data-anchor-id="endogeneity-7-points">Endogeneity (7 points)</h2>
<p>Give one reason why <span class="math inline">\(\Er[Telehealth_{iht} \epsilon_{iht}]\)</span> might not be zero, speculate on the sign of <span class="math inline">\(\Er[Telehealth_{iht} \epsilon_{iht}]\)</span>, and say whether whether you expect <span class="math inline">\(\hat{\beta}_1^{OLS}\)</span> to be greater or less than <span class="math inline">\(\beta_1\)</span>.</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>Patients who choose telehealth instead of an in person visit are likely to have less severe problems, so I think <span class="math inline">\(\Er[Telehealth_{iht} \epsilon_{iht}] &lt; 0\)</span>. <span class="math inline">\(\plim \hat{\beta}_1 = \beta_1 + \frac{\Er[\epsilon \widetilde{Telehealth}_{iht}]}{\Er[\widetilde{Telehealth}_{iht}]}\)</span>, so I expect <span class="math inline">\(\hat{\beta}_1\)</span> to be less than <span class="math inline">\(\beta_1\)</span>.</p>
</div>
</section>
<section id="instrument-7-points" class="level2">
<h2 class="anchored" data-anchor-id="instrument-7-points">Instrument (7 points)</h2>
<p>As an instrument for <span class="math inline">\(Telehealth_{iht}\)</span> the authors use the distance from patient <span class="math inline">\(i\)</span> to provider <span class="math inline">\(h\)</span> minus the distance from patient <span class="math inline">\(i\)</span> to the closest provider. What assumptions must this instrument satisfy for the IV estimator to be consistent?</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>The instrument must be relevant <span class="math inline">\(\Er[Telehealth_{iht} Z_{iht}] \neq 0\)</span> and exogenous, <span class="math inline">\(\Er[Z_{iht} \epsilon_{iht}] = 0\)</span>. It and other variables must also satisfy enough regularity conditions for the LLN to apply (it is okay not to mention this).</p>
</div>
</section>
<section id="instrument-strength-7-points" class="level2">
<h2 class="anchored" data-anchor-id="instrument-strength-7-points">Instrument Strength (7 points)</h2>
<p>The paper does not report the first stage, but the authors do write</p>
<blockquote class="blockquote">
<p>The Kleibergen-Paap rank Wald F statistic is 74.109, which is above the 10% maximal Stock-Yogo critical value, suggesting that the maximum bias in our IV approach can be at most 10% of the bias in an OLS approach. Hence, we conclude that our IVs are not weak and meet the necessary criteria for selection.</p>
</blockquote>
<p>The authors then proceed with reporting standard IV standard errors and confidence intervals. What assumption are the authors checking? Do you agree with their conclusion? What, if anything, would you do differently?</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>The authors are checking for instrument relevance. Recent research argues that the Stock-Yogo critical value is not stringent enough and <span class="math inline">\(F&gt;100\)</span> is needed. Their F statistic is close, but to be safe, I would use an identification robust inference method to calculate confidence intervals.</p>
</div>
</section>
<section id="dependence-7-points-1" class="level2">
<h2 class="anchored" data-anchor-id="dependence-7-points-1">Dependence (7 points)</h2>
<p>Table 2 below shows the IV estimates from <span class="citation" data-cites="ayabakan2024">Ayabakan, Bardhan, and Zheng (<a href="#ref-ayabakan2024" role="doc-biblioref">2024</a>)</span>. Given the structure of the data (it has repeated observations from the same patients, hospitals, and quarters), what is an appropriate assumption to make about the dependence of <span class="math inline">\(\epsilon_{iht}\)</span>? Briefly describe how standard errors could be calculated with this assumption.</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>The standard errors should be clustered to allow for dependence. It seems sensible here to do two way clustering on patient and hospital.</p>
</div>
<p><img src="ayabakan-tab2.png" class="img-fluid" style="width:50.0%"></p>
</section>
<section id="late-7-points" class="level2">
<h2 class="anchored" data-anchor-id="late-7-points">LATE? (7 points)</h2>
<p><span class="citation" data-cites="ayabakan2024">Ayabakan, Bardhan, and Zheng (<a href="#ref-ayabakan2024" role="doc-biblioref">2024</a>)</span> do not use standard 2SLS. Their reasoning is:</p>
<blockquote class="blockquote">
<p>When the endogenous variable is binary, a standard 2SLS approach may yield inconsistent estimates (referred to as forbidden regression) because the fitted values of a binary variable from the first stage estimation will not be binary, nor will they be probabilistic in the second stage (Wooldridge 2010)</p>
</blockquote>
<p>There is a grain of truth in what they say, but also some nonsense. What is a problem with 2SLS if the effect of telemedicine is heterogeneous?</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>If the effect is heterogenous, then a linear IV model is misspecified. If there were no controls and we believed that the instrument has a monotonic effect on telehealth, then the 2SLS would have a LATE intrepretation — it would be the average treatment effect for compliers. However, with linear controls, the LATE interpretation breaks down, and 2SLS no longer captures any interpretable treatment effect.</p>
</div>
</section>
<section id="nonstandard-3sls-7-points" class="level2">
<h2 class="anchored" data-anchor-id="nonstandard-3sls-7-points">Nonstandard 3SLS (7 points)</h2>
<p>(<em>Most difficult</em>) Instead of 2SLS, <span class="citation" data-cites="ayabakan2024">Ayabakan, Bardhan, and Zheng (<a href="#ref-ayabakan2024" role="doc-biblioref">2024</a>)</span> use a three step procedure that they describe as follows:</p>
<blockquote class="blockquote">
<p>Therefore, we adopt a three-step approach where we first estimated a Probit model and regressed Telehealth on our instrumental variable and other controls, including patient, hospital, and time fixed effects (Angrist and Pischke 2008). In the second step, we calculate the predicted values of Telehealth from the first stage, which we denote as Telehealth_hat. In the third step, we follow a regular 2SLS estimation approach with Telehealth_hat being the only IV for the endogenous Telehealth variable. This estimation produces consistent and unbiased estimates (Angrist and Pischke 2008).</p>
</blockquote>
<p>Consider a simplified setting without control variables or fixed effects. Then the three-step estimator described above becomes:</p>
<ol type="1">
<li>Estimate a probit model for <span class="math inline">\(Telehealth_{iht}\)</span> <span class="math display">\[
\hat{\gamma} = \argmax_\gamma \sum_{i,h,t} Telehealth_{iht} \log \Phi(\gamma_0 + \gamma_1 Z_{iht}) + (1-Telehealth_{iht}) \log (1-\Phi(\gamma_0 + \gamma_1 Z_{iht}))
\]</span></li>
<li>First stage of 2SLS with instrument <span class="math inline">\(\widehat{Telehealth}_{iht} = \Phi(\hat{\gamma}_0 + \hat{\gamma}_1 Z_{iht} )\)</span></li>
<li>Second stage gives <span class="math inline">\(\hat{\beta}_1 = \frac{\sum \widehat{Telehealth}_{iht} (Util_{iht} - \overline{Util})}{\sum \widehat{Telehealth}_{iht} (Telehealth_{iht} - \overline{Telehealth})}\)</span></li>
</ol>
<p>Show that this procedure is consistent. State any additional assumptions needed. For the first step, it is okay to just make a high-level assumption like <span class="math inline">\(\plim \hat{\gamma}\)</span> exists.</p>
<div class="proof solution">
<p><span class="proof-title"><em>Solution</em>. </span>To reduce notation, let <span class="math inline">\(x_j = Telehealth_{iht}\)</span>, <span class="math inline">\(y_j = Util_{iht}\)</span>, and <span class="math inline">\(z_j = (1,Z_{iht})'\)</span>. Also assume both <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> have mean 0, so the model is simply <span class="math display">\[
y = x\beta + \epsilon
\]</span> The estimator can be written <span class="math display">\[
\begin{align*}
\hat{\beta} = &amp; \frac{\sum \Phi(z_j'\hat{\gamma}) y_j}{\sum \Phi(z_j'\hat{\gamma}) x_j} \\
= &amp; \beta + \frac{\sum \Phi(z_j'\hat{\gamma}) \epsilon_j}{\sum \Phi(z_j'\hat{\gamma}) x_j}
\end{align*}
\]</span> Assume that <span class="math inline">\(\plim \hat{\gamma} = \gamma\)</span> exists. Write the numerator of <span class="math inline">\(\hat{\beta} - \beta\)</span> as <span class="math display">\[
\frac{1}{n} \sum \Phi(z_j'\hat{\gamma}) \epsilon_j = \frac{1}{n} \sum \Phi(z_j'\gamma) \epsilon_j +
\frac{1}{n} \sum \left(\Phi(z_j'\hat{\gamma})-\Phi(z_j'\gamma)\right) \epsilon_j
\]</span> The intermediate value theorem and the fact that the derivative of <span class="math inline">\(\Phi\)</span> is bounded imply that <span class="math display">\[
\left\vert \frac{1}{n} \sum \left(\Phi(z_j'\hat{\gamma})-\Phi(z_j'\gamma)\right) \epsilon_j \right\vert \leq \Vert \hat{\gamma} - \gamma \Vert \frac{B}{n} \sum \Vert z_j \epsilon_j \Vert
\]</span> If we assume that an LLN applies to <span class="math inline">\(\frac{1}{n} \sum \Vert z_j \epsilon_j \Vert  \inprob \Er[\Vert z\epsilon \Vert]\)</span>, then <span class="math inline">\(\frac{1}{n} \sum \left(\Phi(z_j'\hat{\gamma})-\Phi(z_j'\gamma)\right) \epsilon_j\inprob 0\)</span>.</p>
<p>An identical argument shows that <span class="math display">\[
\frac{1}{n} \sum \Phi(z_j'\hat{\gamma}) x_j = \frac{1}{n} \sum \Phi(z_j'\gamma) x_j + o_p(1)
\]</span></p>
<p>Assume that the LLN applies so <span class="math inline">\(\frac{1}{n} \sum \Phi(z_j'\gamma) \epsilon_j \inprob 0\)</span> and <span class="math inline">\(\frac{1}{n} \sum \Phi(z_j'\gamma) x_j \inprob \Er[\Phi(z_j'\gamma)x_j] \neq 0\)</span>. Conclude that <span class="math inline">\(\hat{\beta} \inprob \beta\)</span>.</p>
</div>
<hr>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-ayabakan2024" class="csl-entry" role="listitem">
Ayabakan, Sezgin, Indranil R. Bardhan, and Zhiqiang (Eric) Zheng. 2024. <span>“Impact of Telehealth and Process Virtualization on Healthcare Utilization.”</span> <em>Information Systems Research</em> 35 (1): 45–65. <a href="https://doi.org/10.1287/isre.2023.1220">https://doi.org/10.1287/isre.2023.1220</a>.
</div>
<div id="ref-epz2011" class="csl-entry" role="listitem">
Enikolopov, Ruben, Maria Petrova, and Ekaterina Zhuravskaya. 2011. <span>“Media and Political Persuasion: Evidence from Russia.”</span> <em>American Economic Review</em> 101 (7): 3253–85. <a href="https://doi.org/10.1257/aer.101.7.3253">https://doi.org/10.1257/aer.101.7.3253</a>.
</div>
<div id="ref-yang2024" class="csl-entry" role="listitem">
Yang, Lin, Yatang Lin, Jin Wang, and Fangyuan Peng. 2024. <span>“Achieving Air Pollution Control Targets with Technology-Aided Monitoring: Better Enforcement or Localized Efforts?”</span> <em>American Economic Journal: Economic Policy</em> 16 (4): 280–315. <a href="https://doi.org/10.1257/pol.20220810">https://doi.org/10.1257/pol.20220810</a>.
</div>
</div>
</section>
<section id="definitions-and-results" class="level1">
<h1>Definitions and Results</h1>
<ul>
<li><p>Measure and Probability:</p>
<ul>
<li><p>Monotone convergence: If <span class="math inline">\(f_n:\Omega \to \mathbf{R}\)</span> are measurable, <span class="math inline">\(f_{n}\geq 0\)</span>, and for each <span class="math inline">\(\omega \in \Omega\)</span>, <span class="math inline">\(f_{n}(\omega )\uparrow f(\omega )\)</span>, then <span class="math inline">\(\int f_{n}d\mu \uparrow \int fd\mu\)</span> as <span class="math inline">\(n\rightarrow \infty\)</span></p></li>
<li><p>Dominated converegence: If <span class="math inline">\(f_n:\Omega \to \mathbf{R}\)</span> are measurable, and for each <span class="math inline">\(\omega \in \Omega\)</span>, <span class="math inline">\(f_{n}(\omega )\rightarrow f(\omega ).\)</span> Furthermore, for some <span class="math inline">\(g\geq 0\)</span> such that <span class="math inline">\(\int gd\mu &lt;\infty\)</span>, <span class="math inline">\(|f_{n}|\leq g\)</span> for each <span class="math inline">\(n\geq 1\)</span>. Then, <span class="math inline">\(\int f_{n}d\mu \rightarrow \int fd\mu\)</span></p></li>
<li><p>Markov’s inequality: <span class="math inline">\(P(|X|&gt;\epsilon) \leq  \frac{\Er[|X|^k]}{\epsilon^k}\)</span> <span class="math inline">\(\forall \epsilon &gt; 0, k &gt; 0\)</span></p></li>
<li><p>Jensen’s inequality: if <span class="math inline">\(g\)</span> is convex, then <span class="math inline">\(g(\Er[X]) \leq \Er[g(X)]\)</span></p></li>
<li><p>Cauchy-Schwarz inequality: <span class="math inline">\(\left(\Er[XY]\right)^2 \leq \Er[X^2] \Er[Y^2]\)</span></p></li>
<li><p>Conditional expection of <span class="math inline">\(Y\)</span> given <span class="math inline">\(\sigma\)</span>-field <span class="math inline">\(\mathscr{G}\)</span> satisfies <span class="math inline">\(\int_A \Er[Y|\mathscr{G}] dP = \int_A Y dP\)</span> <span class="math inline">\(\forall A \in  \mathscr{G}\)</span></p></li>
</ul></li>
<li><p>Identification <span class="math inline">\(X\)</span> observed, distribution <span class="math inline">\(P_X\)</span>, probability model <span class="math inline">\(\mathcal{P}\)</span></p>
<ul>
<li><span class="math inline">\(\theta_0 \in \R^k\)</span> is <strong>identified</strong> in <span class="math inline">\(\mathcal{P}\)</span> if there exists a known <span class="math inline">\(\psi: \mathcal{P} \to \R^k\)</span> s.t. <span class="math inline">\(\theta_0 = \psi(P_X)\)</span></li>
<li><span class="math inline">\(\mathcal{P} = \{ P(\cdot; s) : s \in S \}\)</span>, two structures <span class="math inline">\(s\)</span> and <span class="math inline">\(\tilde{s}\)</span> in <span class="math inline">\(S\)</span> are <strong>observationally equivalent</strong> if they imply the same distribution for the observed data, i.e. <span class="math display">\[ P(B;s) = P(B; \tilde{s}) \]</span> for all <span class="math inline">\(B \in \sigma(X)\)</span>.</li>
<li>Let <span class="math inline">\(\lambda: S \to \R^k\)</span>, <span class="math inline">\(\theta\)</span> is <strong>observationally equivalent</strong> to <span class="math inline">\(\tilde{\theta}\)</span> if <span class="math inline">\(\exists s, \tilde{s} \in S\)</span> that are observationally equivalent and <span class="math inline">\(\theta = \lambda(s)\)</span> and <span class="math inline">\(\tilde{\theta} = \lambda(\tilde{s})\)</span></li>
<li><span class="math inline">\(s_0 \in S\)</span> is <strong>identified</strong> if there is no <span class="math inline">\(s \neq s_0\)</span> that is observationally equivalent to <span class="math inline">\(s_0\)</span></li>
<li><span class="math inline">\(\theta_0\)</span> is <strong>identified</strong> (in <span class="math inline">\(S\)</span>) if there is no observationally equivalent <span class="math inline">\(\theta \neq \theta_0\)</span></li>
</ul></li>
<li><p>Cramér-Rao Bound: in the parametric model <span class="math inline">\(P_X \in \{P_\theta:
\theta \in \R^d\}\)</span> with likelihood <span class="math inline">\(\ell(\theta;x)\)</span>, if appropriate derivatives and integrals can be interchanged, then for any unbiased estimator <span class="math inline">\(\tau(X)\)</span>, <span class="math display">\[
\var_\theta(\tau(X))  \geq I(\theta)^{-1}
\]</span> where <span class="math inline">\(I(\theta) = \int s(x,\theta) s(x,\theta)' dP_\theta(x) = \Er[H(x,\theta)]\)</span> and <span class="math inline">\(s(x,\theta) = \frac{\partial \log \ell(\theta;x)}{\partial \theta}\)</span></p></li>
<li><p>Hypothesis testing:</p>
<ul>
<li><span class="math inline">\(P(\text{reject } H_0 | P_x \in \mathcal{P}_0)\)</span>=<em>Type I error rate</em> <span class="math inline">\(=P_x(C)\)</span></li>
<li><span class="math inline">\(P(\text{fail to reject } H_0 | P_x \in \mathcal{P}_1)\)</span>=<em>Type II error rate</em></li>
<li><span class="math inline">\(P(\text{reject } H_0 | P_x \in \mathcal{P}_1)\)</span> = <em>power</em></li>
<li><span class="math inline">\(\sup_{P_x \in \mathcal{P}_0} P_x(C)\)</span> = <em>size of test</em></li>
<li>Neyman-Pearson Lemma: Let <span class="math inline">\(\Theta = \{0, 1\}\)</span>, <span class="math inline">\(f_0\)</span> and <span class="math inline">\(f_1\)</span> be densities of <span class="math inline">\(P_0\)</span> and <span class="math inline">\(P_1\)</span>, <span class="math inline">\(\tau(x) =f_1(x)/f_0(x)\)</span> and <span class="math inline">\(C^* =\{x \in X: \tau(x) &gt; c\}\)</span>. Then among all tests <span class="math inline">\(C\)</span> s.t. <span class="math inline">\(P_0(C) = P_0(C^*)\)</span>, <span class="math inline">\(C^*\)</span> is most powerful.</li>
</ul></li>
<li><p>Projection: <span class="math inline">\(P_L y \in  L\)</span> is the <strong>projection</strong> of <span class="math inline">\(y\)</span> on <span class="math inline">\(L\)</span> if <span class="math display">\[
\norm{y - P_L y } = \inf_{w \in L} \norm{y - w}
\]</span></p>
<ol type="1">
<li><span class="math inline">\(P_L y\)</span> exists, is unique, and is a linear function of <span class="math inline">\(y\)</span></li>
<li>For any <span class="math inline">\(y_1^* \in L\)</span>, <span class="math inline">\(y_1^* = P_L y\)</span> iff <span class="math inline">\(y- y_1^* \perp L\)</span></li>
<li><span class="math inline">\(G = P_L\)</span> iff <span class="math inline">\(Gy = y \forall y \in L\)</span> and <span class="math inline">\(Gy = 0 \forall y \in
L^\perp\)</span></li>
<li>Linear <span class="math inline">\(G: V \to V\)</span> is a projection map onto its range, <span class="math inline">\(\mathcal{R}(G)\)</span>, iff <span class="math inline">\(G\)</span> is idempotent and symmetric.</li>
</ol></li>
<li><p>Gauss-Markov: <span class="math inline">\(Y = \theta + u\)</span> with <span class="math inline">\(\theta \in L \subset \R^n\)</span>, a known subspace. If <span class="math inline">\(\Er[u] = 0\)</span> and <span class="math inline">\(\Er[uu'] = \sigma^2 I_n\)</span>, then the best linear unbiased estimator (BLUE) of <span class="math inline">\(a'\theta = a'\hat{\theta}\)</span> where <span class="math inline">\(\hat{\theta} = P_L y\)</span></p></li>
<li><p>Convergence in probability:</p>
<ul>
<li><span class="math inline">\(X_1, X_2, ...\)</span> <strong>converge in probability</strong> to <span class="math inline">\(Y\)</span> if <span class="math inline">\(\forall
\epsilon &gt; 0\)</span>, <span class="math inline">\(\lim_{n \to \infty} P(\norm{X_n -Y} &gt; \epsilon) = 0\)</span></li>
<li>If <span class="math inline">\(\lim_{n \to \infty} \Er[ \norm{X_n - Y}^p ] \to 0\)</span>, then <span class="math inline">\(X_n
\inprob Y\)</span></li>
<li>If <span class="math inline">\(X_n \inprob X\)</span>, and <span class="math inline">\(f\)</span> continuous, then <span class="math inline">\(f(X_n) \inprob f(X)\)</span></li>
<li>Weak LLN: if <span class="math inline">\(X_1, ..., X_n\)</span> are i.i.d. and <span class="math inline">\(\Er[X^2]\)</span> exists, then <span class="math inline">\(\frac{1}{n} \sum_{i=1}^n X_i \inprob \Er[X]\)</span></li>
<li><span class="math inline">\(X_n = O_p(b_n)\)</span> if <span class="math inline">\(\forall \epsilon&gt;0\)</span> <span class="math inline">\(\exists M_\epsilon\)</span> s.t. <span class="math inline">\(\lim\sup P(\frac{\norm{X_n}}{b_n} \geq M_\epsilon) &lt; \epsilon\)</span></li>
<li><span class="math inline">\(X_n = o_p(b_n)\)</span> if <span class="math inline">\(\frac{X_n}{b_n} \inprob 0\)</span></li>
</ul></li>
<li><p>Convergence in distribution:</p>
<ul>
<li><span class="math inline">\(X_1, X_2, ...\)</span> converge in distribution to <span class="math inline">\(X\)</span> if <span class="math inline">\(\forall f \in
\mathcal{C}_b\)</span>, <span class="math inline">\(\Er[f(X_n)] \to \Er[f(X)]\)</span></li>
<li>If <span class="math inline">\(X_n \indist X\)</span> and <span class="math inline">\(g\)</span> is continuous, then <span class="math inline">\(g(X_n) \indist
g(X)\)</span></li>
<li>Slutsky’s lemma: if <span class="math inline">\(Y_n \inprob c\)</span> and <span class="math inline">\(X_n \indist X\)</span> and <span class="math inline">\(g\)</span> is continuious, then <span class="math inline">\(g(Y_n, X_n) \indist g(c,X)\)</span></li>
<li>Levy’s Continuity Theorem: <span class="math inline">\(X_n \indist X\)</span> iff <span class="math inline">\(\Er[e^{it'X_n}]
\to \Er[e^{it'X}] \forall t\)</span></li>
<li>CLT: if <span class="math inline">\(X_1, ..., X_n\)</span> are i.i.d. with <span class="math inline">\(\Er[X_1] = \mu\)</span> and <span class="math inline">\(\var(X_1) = \sigma^2\)</span>, then <span class="math inline">\(\frac{1}{\sqrt{n}} \sum_{i=1}^n
\frac{X_i - \mu}{\sigma} \indist N(0,1)\)</span></li>
<li>Delta Method: suppose <span class="math inline">\(\sqrt{n}(\hat{\theta} - \theta_0) \indist S\)</span> and <span class="math inline">\(h\)</span> is differentiable, then <span class="math inline">\(\sqrt{n}(h(\hat{\theta}) - h(\theta_0)) \indist \nabla_h(\theta_0)
S\)</span></li>
</ul></li>
<li><p>Asymptotic distribution of OLS:</p>
<ul>
<li>Model <span class="math inline">\(Y_i = X_i'\beta + \epsilon_i\)</span></li>
<li><span class="math inline">\(\hat{\beta}^{OLS} = (X'X)^{-1} X'y\)</span></li>
<li>If observations are i.i.d., <span class="math inline">\(\Er[X_i \epsilon] = 0\)</span>, <span class="math inline">\(\Er[X_i X_i'] &lt; \infty\)</span>, and <span class="math inline">\(\Er[X_i  X_i' \epsilon_i^2] &lt; \infty\)</span>, then <span class="math display">\[
\sqrt{n}(\hat{\beta}^{OLS} - \beta) \left((\frac{1}{n} X'X)^{-1} \left( \frac{1}{n} \sum X_i X_i' \hat{\epsilon}_i^2 \right) (\frac{1}{n} X'X)^{-1} \right)^{-1/2} \indist N(0,I)
\]</span></li>
</ul></li>
<li><p>Difference in differences:</p>
<ul>
<li>TWFE: <span class="math inline">\(y_{it} = \beta D_{it} + \alpha_i + \delta_t + \epsilon_{it}\)</span></li>
<li><span class="math inline">\(\hat{\beta}^{FE} = \sum_{i=1,t=1}^{n,T} y_{it}(0) \hat{\omega}_{it} + \sum_{i=1,t=1}^{n,T} D_{it} (y_{it}(1) - y_{it}(0)) \hat{\omega}_{it}\)</span>
<ul>
<li>where <span class="math inline">\(\hat{\omega}_{it} = \frac{D_{it} - \bar{D}_i - \bar{D}_t
+ \bar{D}}{\sum_{j,s} (D_{jt} - \bar{D}_j - \bar{D}_s
+ \bar{D})^2}\)</span></li>
</ul></li>
</ul></li>
<li><p>IV</p>
<ul>
<li><span class="math inline">\(\hat{\beta}^{2SLS} = (X'P_Z X)^{-1} (X' P_Z y)\)</span></li>
<li>If observations are i.i.d. <span class="math inline">\(rank(\Er[X_i Z_i']) = k\)</span>, <span class="math inline">\(\Er[Z_i
\epsilon_i] = 0\)</span>, <span class="math inline">\(\Er\norm{X_i}^4 &lt; \infty\)</span>, <span class="math inline">\(\Er\norm{Z_i}^4 &lt;
\infty\)</span>, <span class="math inline">\(\Er[\epsilon_i^2 | Z_i] = \sigma^2\)</span>, and <span class="math inline">\(\Er[Z_i Z_i']\)</span> is invertible, then <span class="math display">\[
\sqrt{n}(\hat{\beta}^{2SLS} - \beta) \indist N\left(0, \sigma^2 \left\lbrace \Er[X_i Z_i'] \Er[Z_i Z_i']^{-1} \Er[Z_i X_i'] \right\rbrace^{-1} \right)
\]</span></li>
<li>J-test: under <span class="math inline">\(H_0: \Er[Z_i(Y-X_i'\beta_0)] = 0\)</span>, <span class="math display">\[
J = n\left(\frac{1}{n}Z'(y - X\hat{\beta}^{2SLS}) \right)'
\hat{C}\left(\frac{1}{n}Z'(y - X\hat{\beta}^{2SLS}) \right) \indist
\chi^2_{d-k}
\]</span></li>
<li>AR-test: under <span class="math inline">\(H_0: \beta = \beta_0\)</span>, <span class="math display">\[
AR(\beta) = n\left(\frac{1}{n}Z'(y - X\beta) \right)'
\hat{\Sigma}(\beta)^{-1}\left(\frac{1}{n}Z'(y - X\beta) \right) \indist \chi^2_d
\]</span></li>
</ul></li>
<li><p>GMM : <span class="math inline">\(\Er\left[g(Z_i,\theta_0) \right] = 0\)</span> iff <span class="math inline">\(\theta=\theta_0\)</span></p>
<ul>
<li>Estimator <span class="math inline">\(\hat\theta = \argmin_\theta \frac{1}{2} \En[g(Z_i,\theta)]'S_n'S_n\En[g(Z_i,\theta)]\)</span></li>
<li>Consistent if:
<ol type="1">
<li><span class="math inline">\(\exists \theta_0 \in \Theta\)</span> s.t. <span class="math inline">\(\forall \epsilon&gt;0\)</span>, <span class="math inline">\(\inf_{\theta: \norm{\theta-\theta_0} &gt; \epsilon} \norm{\Er[g(Z_i,\theta)]} &gt; \norm{\Er[g(Z_i,\theta_0)]}\)</span></li>
<li><span class="math inline">\(\sup_{\theta \in \Theta} \norm{\En[g(Z_i,\theta)] - \Er[g(Z_i,\theta)]} \inprob 0\)</span></li>
<li><span class="math inline">\(S_n \inprob S\)</span></li>
</ol></li>
<li>Asymptotic normality if:
<ol type="1">
<li><span class="math inline">\(\theta_0 \in int(\Theta)\)</span>, &amp; <span class="math inline">\(g(z,\theta)\)</span> is twice continuously differentiable</li>
<li><span class="math inline">\(\sqrt{n} \frac{\partial}{\partial \theta} \hat{Q}^{GMM}(\theta_0)
\indist N(0,\Omega)\)</span></li>
<li><span class="math inline">\(\sup_{\theta \in int(\Theta)} \norm{\frac{\partial^2}{\partial
\theta \partial \theta'} \hat{Q}^{GMM}(\theta) - B(\theta)}
\inprob 0\)</span> with <span class="math inline">\(B(\cdot)\)</span> continuous at <span class="math inline">\(\theta_0\)</span> and <span class="math inline">\(B(\theta_0) &gt; 0\)</span></li>
</ol></li>
</ul>
<p>Then <span class="math inline">\(\sqrt{n}(\hat{\theta} - \theta_0) \indist N(0, B_0^{-1} \Omega_0 B_0^{-1})\)</span></p></li>
</ul>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>The appendix of <span class="citation" data-cites="yang2024">Yang et al. (<a href="#ref-yang2024" role="doc-biblioref">2024</a>)</span> does include an alternative appropriate estimator.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>